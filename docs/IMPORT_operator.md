---
title: 'Оператор IMPORT'
---

Оператор **IMPORT **- создание [действия](Actions.md), импортирующего данные из заданного файла в [заданные свойства (параметры)](Data_import_IMPORT_.md) или, в общем случае, в [заданную форму](In_a_structured_view_EXPORT_IMPORT_.md#importForm).

### Синтаксис

    IMPORT [importFormat] FROM fileExpr importDestination [DO actionOperator [ELSE elseActionOperator]]
    IMPORT formName [importFormat] [FROM (fileExpr | (groupId1 = fileExpr1 [, ..., groupIdM = fileExprM])]

*importFormat* может задаваться одним из следующих вариантов:

    JSON [CHARSET charsetStr]
    XML [ATTR] [CHARSET charsetStr]
    CSV [separator] [HEADER | NOHEADER] [ESCAPE | NOESCAPE] [CHARSET charsetStr]
    XLS [HEADER | NOHEADER] [SHEET (sheetExpr | ALL)]
    DBF [CHARSET charsetStr]
    TABLE

*importDestination* может задаваться одним из следующих вариантов:

    TO [(objClassId1, objClassId2, ..., objClassIdK)] propertyId1 [= columnId1], ..., propertyIdN [= columnIdN] [WHERE whereId]
    FIELDS [(objClassId1 objAlias1, objClassId2 objAlias1, ..., objClassIdK objAliasK)] propClassId1 [propAlias1 =] columnId1 [NULL], ..., propClassIdN [propAliasN =] columnIdN [NULL]

    Описание

Оператор **IMPORT **создает действие, которое импортирует данные из файла в значения заданных свойств или в заданную форму. 

Если* *формат импортируемого файла* *не задан, то он автоматически определяется, в зависимости от класса импортируемого файла (или от расширения, если этот класс равен **FILE**), следующим образом:

|<p>Формат</p>|<p>Расширение</p>|Класс|
|---|---|---|
|<strong>JSON</strong>|json|<strong>JSONFILE</strong>|
|<strong>XML</strong>|xml|<strong>XMLFILE</strong>|
|<strong>CSV</strong>|csv|<strong>CSVFILE</strong>|
|<strong>XLS</strong>|xls или xlsx|<strong>EXCELFILE</strong>|
|<strong>DBF</strong>|dbf|<strong>DBFFILE</strong>|
|<strong>TABLE</strong>|table|<strong>TABLEFILE</strong>|

  

Для автоматического определения плоского формата файла по его расширению используется первый переданный файл

### Параметры

### *Источник импорта*

*fileExpr*

[Выражение](Expression.md), значением которого является импортируемый файл. Значение выражения должно быть объектом файлового класса (**FILE**, **RAWFILE**, **JSONFILE** и т. д.). Если при импорте формы это выражение не указано, то по умолчанию используется выражение **System.importFile()**.

*groupId1, ..., groupIdM*

Имена групп объектов импортируемой формы, для которых необходимо импортировать данные. [Простые идентификаторы](IDs.md#id-broken). Используется только для импорта формы из плоских форматов.

*fileExpr1 , ..., fileExprM*

Выражения, значения которых являются файлами, которые необходимо импортировать для заданных групп объектов. Значения выражений должны быть объектами файлового класса (**FILE**, **RAWFILE**, **JSONFILE** и т. д.). Используется только для импорта формы из плоских форматов. Для [пустой группы](Static_view.md#empty) объектов используется имя **root**. 

### *Формат импорта*

*ATTR*

Ключевое слово, указывающее на чтение значений из атрибутов элемента. Если не указывается, то чтение производится из дочерних элементов. Применяется только для импорта **XML**.

*separator*

Разделитель в **CSV** файле. [Строковый литерал](Literals.md#strliteral-broken). Если не указывается, то по умолчанию берётся разделитель '**;**'.

*HEADER | NOHEADER*

Ключевые слова, указывающие на присутствие (**HEADER**) или отсутствие (**NOHEADER**) в **CSV** / **XLS** файле строки заголовка, в которой содержатся имена колонок. По умолчанию используется **NOHEADER**.

При использовании опции **NOHEADER**:

-   -   именами колонок считаются : A, B, ..., Z, AA, ...,  AE, ...
    -   если колонка не найдена / не соответствует типу свойства назначения, значением этой колонки считается значение **NULL** (в остальных форматах импорта в этих случаях платформа выдает ошибку).

*ESCAPE | NOESCAPE*

Ключевое слово, указывающее на присутствие (**ESCAPE**) или отсутствие (**NOESCAPE**) в **CSV** файле экранирования спецсимволов (\\r, \\n, " (двойные кавычки)) и указанного разделителя (*separator*). **NOESCAPE** имеет смысл использовать, только в случаях, когда в данных гарантировано не будет заданного разделителя. По умолчанию используется **ESCAPE**.

*SHEET sheetExpr*

Опция, указывающая на импорт конкретного листа Excel файла. Если опция не указана, то берется лист номер один.

sheetExpr - выражение, значение которого определяет номер импортируемого листа Excel файла. Значение выражения должно иметь класс **INTEGER** или **LONG**. Нумерация начинается с единицы.

ALL - ключевое слово, которое означает, что импорт будет производится из всех листов excel файла.

*CHARSET charsetStr*

Опция, указывающая кодировку файла, используемую при импорте.

charsetStr - строковый литерал, определяющий кодировку. 

*actionOperator*

[Контекстно-зависимый оператор-действие](Action_operator.md#contextdependent), описывающий действие, которое выполняется для каждой импортированной записи.

*elseActionOperator*

Контекстно-зависимый оператор-действие, описывающий действие, которое выполняется, если ни одной записи импортировано не было. В качестве параметров нельзя использовать параметры, в которые импортируются данные.

### *Назначение импорта*

*formName*

Имя формы, в которую необходимо импортировать данные. [Составной идентификатор](IDs.md#cid-broken).

*objClassId1, ..., objClassIdK*

Классы [импортируемых](Data_import_IMPORT_.md#objects-broken) объектов. Задаются [идентификаторами класса](IDs.md#classid-broken). K <= 1. По умолчанию считается, что импортируется один объект класса **INTEGER**.

*objAlias1, ..., objAliasK*

Имена локальных параметров, в которые записываются импортируемые объекты. [Простые идентификаторы](IDs.md#id-broken). K <= 1. По умолчанию считается, что импортируется один объект с именем **row**.

*propertyId1, ..., propertyIdN*

Список [идентификаторов свойств](IDs.md#propertyid-broken), в которые импортируются колонки (поля) данных. Параметры свойств и их классы должны соответствовать импортируемым объектам и их классам.

*columnId1, ..., columnIdN*

Список идентификаторов колонок в исходном файле, из которых будут переноситься данные в соответствующее свойство. Каждый элемент списка задается либо простым идентификатором, либо строковым литералом. При указании идентификатора несуществующей колонки или при отсутствии идентификатора, за колонку, соответствующую свойству, принимается колонка, следующая по порядку за указанной для предыдущего свойства в списке, либо первая, если указывается первое свойство. Для файлов **DBF** идентификаторы колонок являются регистронезависимыми. 

*whereId*

Идентификатор свойства, в которое будет записано [значение по умолчанию](Built-in_classes.md#defaultvalue) класса значения этого свойства для каждого импортируемого объекта. Параметры свойства и его классы должны соответствовать импортируемым объектам и их классам. Если это свойство не задано и количество импортируемых объектов больше 0, по умолчанию осуществляется поиск свойства с именем **imported** и классами импортируемых объектов (например **System.imported\[INTEGER\]**).

*propClassId1, ..., *propClassId*N*

Список имен [встроенных классов](Built-in_classes.md) импортируемых колонок.

*propAlias1, ..., propAliasN*

Имена локальных параметров, в которые импортируются колонки (поля) данных. Простые идентификаторы. Если имя не задается, то в качестве имени параметра будет использовано имя колонки (поля) в исходном файле.

*NULL*

Ключевое слово. Обозначает, что **NULL** значения при импорте (если импортируемый формат их поддерживает) не будут заменяться на значения по умолчанию (например, 0 - для чисел, пустые строки - для строк и т. п.).

### Примеры


import {CodeSample} from './CodeSample.mdx'

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=ActionSample&block=import"/>

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=ActionSample&block=importForm"/>
