---
title: 'How-to: Наследование и агрегации'
---

Для демонстрации принципов наследования и агрегирования объектов, реализуем логику по созданию партий на основе документов поступления и производства. Сделаем так, чтобы каждый такой документ, для которого проставлен признак Проведен, автоматически генерировал ровно одну новую партию товара.

Создаем в логике понятие товар, партии которого будут учитываться :

import {CodeSample} from './CodeSample.mdx'

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=item"/>

Создадим [класс](Static_objects.md) **Receipt**, объекты которого будут отражать поступление товаров :

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=receipt"/>

В данном случае, для примера используем упрощенную схему с одним классом. На практике обычно используются два класса : **Receipt** (для документов) и **ReceiptDetail **(для строк документов).

По аналогии создадим класс Production, который будет использоваться для отражения производства товаров :

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=production"/>

На данный момент мы создавали только обычные классы без какого-либо наследования. Для реализации логики партии создадим абстрактный класс **Batch** :

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=batch"/>

Каждый объект этого класса будет соответствовать одной партии конкретного товара. Все его [свойства](Properties.md) объявлены абстрактными, то есть их реализация будет отличаться в зависимости от конкретного класса партии.

В системе не могут быть созданы объекта непосредственно абстрактного класса **Batch**. Для этого должны быть объявлены конкретные классы, которые будут от него унаследованы. В частности, создадим класс для партий, создаваемых на основе поступления товаров :

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=receiptbatch"/>

При помощи оператор [AGGR](AGGR_operator.md) для каждого объекта класса **Receipt**, у которого значение свойства **posted** определено, будет автоматически создаваться (и удаляться) объект класса **ReceiptBatch**. При этом создаются два свойства со ссылками этих объектов друг на друга : **batch(Receipt r)** и **receipt(ReceiptBatch b)**.

Дальше остается унаследовать класс **ReceiptBatch** от **Batch**, чтобы все партии, создаваемые документом поступления, также являлись объектами абстрактного класса (то есть ранее объявленными партиями) :

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=receiptbatchextend"/>

Наследование производится при помощи оператора [EXTEND CLASS](EXTEND_CLASS_instruction.md). После этого для каждого абстрактного свойства **Batch** задается, каким образом оно должно рассчитываться для конкретного класса **ReceiptBatch**. Значения даты и товара подтягиваются от документа поступления через ссылку **receipt(ReceiptBatch b)**. В тип партии подставляется нужная строка с условием, что объект нужного класса (иначе выражение будет определено для объектов любого класса, и система выдаст ошибку о несоответствии сигнатуры).

Следует отметить, что унаследовать класс можно было и непосредственно при объявлении класса **ReceiptBatch**.

По аналогии создаем партии для документов производства :

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=productionbatch"/>

При необходимости можно создать класс для ручного ввода партий самим пользователем :

<CodeSample url="https://ru-documentation.lsfusion.org/sample?file=UseCaseInheritance&block=userbatch"/>

  
